{
  "relationshiplist": [
    {
      "sub": "Spring4Shell",
      "rel": "named by analogy with",
      "rel_type": [
        "compares-to"
      ],
      "obj": "Log4Shell"
    },
    {
      "sub": "Spring4Shell",
      "rel": "uses",
      "rel_type": [
        "uses"
      ],
      "obj": "data binding"
    },
    {
      "sub": "data binding",
      "rel": "to bind data stored within",
      "rel_type": [
        "uses"
      ],
      "obj": "HTTP request"
    },
    {
      "sub": "Spring4Shell",
      "rel": "exists in",
      "rel_type": [
        "is-part-of"
      ],
      "obj": "getCachedIntrospectionResults method"
    },
    {
      "sub": "Spring4Shell",
      "rel": "is similar to",
      "rel_type": [
        "compares-to"
      ],
      "obj": "CVE-2010-1622"
    },
    {
      "sub": "attacker",
      "rel": "can overwrite",
      "rel_type": [
        "modifies-or-removes-or-replaces"
      ],
      "obj": "Tomcat logging configuration"
    },
    {
      "sub": "attacker",
      "rel": "can upload",
      "rel_type": [
        "uses"
      ],
      "obj": "JSP web shell"
    },
    {
      "sub": "attacker",
      "rel": "to execute",
      "rel_type": [
        "executes"
      ],
      "obj": "arbitrary commands"
    },
    {
      "sub": "Spring4Shell",
      "rel": "affects",
      "rel_type": [
        "targets"
      ],
      "obj": "JDK version 9+"
    },
    {
      "sub": "Spring4Shell",
      "rel": "affects",
      "rel_type": [
        "targets"
      ],
      "obj": "Apache Tomcat"
    },
    {
      "sub": "Spring4Shell",
      "rel": "affects",
      "rel_type": [
        "targets"
      ],
      "obj": "Spring Framework"
    },
    {
      "sub": "Spring4Shell",
      "rel": "affects",
      "rel_type": [
        "targets"
      ],
      "obj": "WAR file"
    },
    {
      "sub": "CVE-2022-22963",
      "rel": "is a vulnerability in",
      "rel_type": [
        "other"
      ],
      "obj": "Spring Cloud Function"
    },
    {
      "sub": "CVE-2022-22963",
      "rel": "allows",
      "rel_type": [
        "leads-to"
      ],
      "obj": "code injection"
    },
    {
      "sub": "code injection",
      "rel": "through",
      "rel_type": [
        "uses"
      ],
      "obj": "Spring Expression Language"
    },
    {
      "sub": "code injection",
      "rel": "by adding",
      "rel_type": [
        "uses"
      ],
      "obj": "spring.cloud.function.routing-expression header"
    },
    {
      "sub": "CVE-2022-22963",
      "rel": "can be used for",
      "rel_type": [
        "leads-to"
      ],
      "obj": "remote code execution"
    },
    {
      "sub": "PDM:Exploit.Win32.Generic",
      "rel": "indicates",
      "rel_type": [
        "indicates"
      ],
      "obj": "Spring4Shell"
    },
    {
      "sub": "UMIDS:Intrusion.Generic.Agent.gen",
      "rel": "indicates",
      "rel_type": [
        "indicates"
      ],
      "obj": "Spring4Shell"
    },
    {
      "sub": "Intrusion.Generic.CVE-*.*",
      "rel": "indicates",
      "rel_type": [
        "indicates"
      ],
      "obj": "Spring4Shell"
    },
    {
      "sub": "7e46801dd171bb5bf1771df1239d760c",
      "rel": "is hash of",
      "rel_type": [
        "indicates"
      ],
      "obj": "shell.jsp"
    },
    {
      "sub": "3de4e174c2c8612aebb3adef10027679",
      "rel": "is hash of",
      "rel_type": [
        "indicates"
      ],
      "obj": "exploit.py"
    }
  ],
  "entitylist": [
    {
      "name": "Spring4Shell",
      "type": "vulnerability",
      "alias": [
        "CVE-2022-22965",
        "SpringShell",
        "shell.jsp"
      ],
      "mother entity": [
        "None"
      ]
    },
    {
      "name": "CVE-2022-22963",
      "type": "vulnerability",
      "alias": [
        "None"
      ],
      "mother entity": [
        "None"
      ]
    },
    {
      "name": "attacker",
      "type": "threat-actor-or-intrusion-set",
      "alias": [
        "None"
      ],
      "mother entity": [
        "None"
      ]
    },
    {
      "name": "Log4Shell",
      "type": "vulnerability",
      "alias": [
        "None"
      ],
      "mother entity": [
        "None"
      ]
    },
    {
      "name": "data binding",
      "type": "detailed-part-of-general-software",
      "alias": [
        "None"
      ],
      "mother entity": [
        "Spring Framework"
      ]
    },
    {
      "name": "HTTP request",
      "type": "network-traffic",
      "alias": [
        "None"
      ],
      "mother entity": [
        "None"
      ]
    },
    {
      "name": "getCachedIntrospectionResults method",
      "type": "detailed-part-of-general-software",
      "alias": [
        "None"
      ],
      "mother entity": [
        "Spring Framework"
      ]
    },
    {
      "name": "CVE-2010-1622",
      "type": "vulnerability",
      "alias": [
        "None"
      ],
      "mother entity": [
        "None"
      ]
    },
    {
      "name": "Tomcat logging configuration",
      "type": "detailed-part-of-general-software",
      "alias": [
        "None"
      ],
      "mother entity": [
        "Apache Tomcat"
      ]
    },
    {
      "name": "JSP web shell",
      "type": "malware",
      "alias": [
        "None"
      ],
      "mother entity": [
        "None"
      ]
    },
    {
      "name": "Apache Tomcat",
      "type": "general-software",
      "alias": [
        "None"
      ],
      "mother entity": [
        "None"
      ]
    },
    {
      "name": "WAR file",
      "type": "file",
      "alias": [
        "None"
      ],
      "mother entity": [
        "None"
      ]
    },
    {
      "name": "Spring Cloud Function",
      "type": "general-software",
      "alias": [
        "None"
      ],
      "mother entity": [
        "None"
      ]
    },
    {
      "name": "code injection",
      "type": "attack-pattern",
      "alias": [
        "None"
      ],
      "mother entity": [
        "None"
      ]
    },
    {
      "name": "Spring Expression Language",
      "type": "detailed-part-of-general-software",
      "alias": [
        "SpEL"
      ],
      "mother entity": [
        "Spring Framework"
      ]
    },
    {
      "name": "spring.cloud.function.routing-expression header",
      "type": "detailed-part-of-general-software",
      "alias": [
        "None"
      ],
      "mother entity": [
        "Spring Cloud Function"
      ]
    },
    {
      "name": "PDM:Exploit.Win32.Generic",
      "type": "indicator",
      "alias": [
        "None"
      ],
      "mother entity": [
        "None"
      ]
    },
    {
      "name": "UMIDS:Intrusion.Generic.Agent.gen",
      "type": "indicator",
      "alias": [
        "None"
      ],
      "mother entity": [
        "None"
      ]
    },
    {
      "name": "Intrusion.Generic.CVE-*.*",
      "type": "indicator",
      "alias": [
        "None"
      ],
      "mother entity": [
        "None"
      ]
    },
    {
      "name": "7e46801dd171bb5bf1771df1239d760c",
      "type": "indicator",
      "alias": [
        "shell.jsp"
      ],
      "mother entity": [
        "None"
      ]
    },
    {
      "name": "shell.jsp",
      "type": "file",
      "alias": [
        "7e46801dd171bb5bf1771df1239d760c"
      ],
      "mother entity": [
        "None"
      ]
    },
    {
      "name": "3de4e174c2c8612aebb3adef10027679",
      "type": "indicator",
      "alias": [
        "exploit.py"
      ],
      "mother entity": [
        "None"
      ]
    },
    {
      "name": "exploit.py",
      "type": "file",
      "alias": [
        "3de4e174c2c8612aebb3adef10027679"
      ],
      "mother entity": [
        "None"
      ]
    },
    {
      "name": "arbitrary commands",
      "type": "attack-pattern",
      "alias": [
        "None"
      ],
      "mother entity": [
        "None"
      ]
    },
    {
      "name": "JDK version 9+",
      "type": "general-software",
      "alias": [
        "None"
      ],
      "mother entity": [
        "None"
      ]
    },
    {
      "name": "Spring Framework",
      "type": "general-software",
      "alias": [
        "None"
      ],
      "mother entity": []
    },
    {
      "name": "remote code execution",
      "type": "attack-pattern",
      "alias": [
        "None"
      ],
      "mother entity": []
    }
  ],
  "content": "Spring4Shell (CVE-2022-22965): details and mitigations | Securelist\nSpring4Shell (CVE-2022-22965): details and mitigations\n04 Apr 2022\nCVE-2022-22965 and CVE-2022-22963: technical detailsMitigations for Spring vulnerabilities exploitationIndicators of Compromise\nAMR\nLast week researchers found the critical vulnerability CVE-2022-22965 in Spring – the open source Java framework.\nUsing the vulnerability, an attacker can execute arbitrary code on a remote web server, which makes CVE-2022-22965 a critical threat, given the Spring framework’s popularity.\nBy analogy with the infamous Log4Shell threat, the vulnerability was named Spring4Shell.\nCVE-2022-22965 and CVE-2022-22963: technical details\nCVE-2022-22965 (Spring4Shell, SpringShell) is a vulnerability in the Spring Framework that uses data binding functionality to bind data stored within an HTTP request to certain objects used by an application.\nThe bug exists in the getCachedIntrospectionResults method, which can be used to gain unauthorized access to such objects by passing their class names via an HTTP request.\nIt creates the risks of data leakage and remote code execution when special object classes are used.\nThis vulnerability is similar to the long-closed CVE-2010-1622, where class name checks were added as a fix so that the name did not match classLoader or protectionDomain.\nHowever, in a newer version of JDK an alternative method exists for such exploitation, for example, through Java 9 Platform Module System functionality.\nSo an attacker can overwrite the Tomcat logging configuration and then upload a JSP web shell to execute arbitrary commands on a server running a vulnerable version of the framework.\nA vulnerable configuration consists of:\nJDK version 9+\nApache Tomcat for serving the application\nSpring Framework versions 5.3.0 to 5.3.17 and 5.2.0 to 5.2.19 and below\napplication built as a WAR file\nCVE-2022-22963 is a vulnerability in the routing functionality of Spring Cloud Function that allows code injection through Spring Expression Language (SpEL) by adding a special spring.cloud.function.routing-expression header to an HTTP request.\nSpEL is a special expression language created for Spring Framework that supports queries and object graph management at runtime.\nThis vulnerability can also be used for remote code execution.\nA vulnerable configuration consists of:\nSpring Cloud Function 3.1.6, 3.2.2 and older versions\nMitigations for Spring vulnerabilities exploitation\nCVE-2022-22965 is fixed in 2.6.6; see the Spring blog for details.\nTo fix CVE-2022-22963, you also need to install the new Spring Cloud Function versions; see the VMware website for details.\nTo detect exploitation attempts, ensure that Advanced Exploit Prevention and Network Attack Blocker features are enabled.\nSome techniques used during exploitation can be seen in other exploits that we detect, which is why the verdict names can differ.\nIndicators of Compromise\nVerdicts\nPDM:Exploit.\nWin32.Generic\nUMIDS:Intrusion.Generic.Agent.gen\nIntrusion.Generic.CVE-*.*\nMD5 hashes of the exploits\n7e46801dd171bb5bf1771df1239d760c – shell.jsp (CVE-2022-22965)\n3de4e174c2c8612aebb3adef10027679 – exploit.py (CVE-2022-22965)\nDetection of the exploitation process with Kaspersky EDR Expert\nJava\nMalware Descriptions\nAMR\nSpring4Shell (CVE-2022-22965): details and mitigations\nA\nPosted on\nSeptember 6, 2022. 9:11 pm\nI can describe some of unknown agent,sites people,technical questions and…\nReply\nCVE-2022-22965 and CVE-2022-22963: technical detailsMitigations for Spring vulnerabilities exploitationIndicators of Compromise\nIT threat evolution in Q3 2022. Non-mobile statistics\nIT threat evolution in Q2 2022. Non-mobile statistics\nCVE-2022-30190 (Follina) vulnerability in MSDT: description and counteraction\nIT threat evolution in Q1 2022. Non-mobile statistics\nEmotet modules and recent attacks\nOngoing exploitation of CVE-2022-41352 (Zimbra 0-day)\nTwo more malicious Python packages in the PyPI\nLofyLife: malicious npm packages steal Discord tokens and bank card data\nCVE-2022-30190 (Follina) vulnerability in MSDT: description and counteraction\nCVE-2022-0847 aka Dirty Pipe vulnerability in Linux kernel",
  "idorurl": "https://securelist.com/spring4shell-cve-2022-22965/106239/"
}