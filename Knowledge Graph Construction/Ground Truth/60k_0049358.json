{
  "relationshiplist": [
    {
      "sub": "CERBER",
      "rel": "uses",
      "rel_type": [
        "uses"
      ],
      "obj": "new loader"
    },
    {
      "sub": "new loader",
      "rel": "hollow out",
      "rel_type": [
        "uses"
      ],
      "obj": "normal process"
    },
    {
      "sub": "Delivery via email",
      "rel": "contain a link to",
      "rel_type": [
        "delivers"
      ],
      "obj": "self-extracting archive"
    },
    {
      "sub": "self-extracting archive",
      "rel": "has been uploaded to",
      "rel_type": [
        "other"
      ],
      "obj": "Dropbox account"
    },
    {
      "sub": "Attacker(using: CERBER)",
      "rel": "controlled",
      "rel_type": [
        "controls"
      ],
      "obj": "Dropbox account"
    },
    {
      "sub": "self-extracting archive",
      "rel": "contains",
      "rel_type": [
        "consists-of"
      ],
      "obj": "38oDr5.vbs"
    },
    {
      "sub": "self-extracting archive",
      "rel": "contains",
      "rel_type": [
        "consists-of"
      ],
      "obj": "8ivq.dll"
    },
    {
      "sub": "self-extracting archive",
      "rel": "contains",
      "rel_type": [
        "consists-of"
      ],
      "obj": "x"
    },
    {
      "sub": "Windows Script Host",
      "rel": "run",
      "rel_type": [
        "executes"
      ],
      "obj": "38oDr5.vbs"
    },
    {
      "sub": "38oDr5.vbs",
      "rel": "using",
      "rel_type": [
        "uses"
      ],
      "obj": "rundll32.exe"
    },
    {
      "sub": "38oDr5.vbs",
      "rel": "loads",
      "rel_type": [
        "uses"
      ],
      "obj": "8ivq.dll"
    },
    {
      "sub": "8ivq.dll",
      "rel": "reads",
      "rel_type": [
        "uses"
      ],
      "obj": "x"
    },
    {
      "sub": "new loader",
      "rel": "check if running in",
      "rel_type": [
        "malicious-investigates-track-detects"
      ],
      "obj": "virtual machine"
    },
    {
      "sub": "new loader",
      "rel": "check if running in",
      "rel_type": [
        "malicious-investigates-track-detects"
      ],
      "obj": "sandbox"
    },
    {
      "sub": "new loader",
      "rel": "check for",
      "rel_type": [
        "malicious-investigates-track-detects"
      ],
      "obj": "Msconfig"
    },
    {
      "sub": "new loader",
      "rel": "check for",
      "rel_type": [
        "malicious-investigates-track-detects"
      ],
      "obj": "Regedit"
    },
    {
      "sub": "new loader",
      "rel": "check for",
      "rel_type": [
        "malicious-investigates-track-detects"
      ],
      "obj": "Task Manager"
    },
    {
      "sub": "new loader",
      "rel": "check for",
      "rel_type": [
        "malicious-investigates-track-detects"
      ],
      "obj": "Wireshark"
    },
    {
      "sub": "new loader",
      "rel": "check for presence of",
      "rel_type": [
        "malicious-investigates-track-detects"
      ],
      "obj": "360"
    },
    {
      "sub": "new loader",
      "rel": "check for presence of",
      "rel_type": [
        "malicious-investigates-track-detects"
      ],
      "obj": "AVG"
    },
    {
      "sub": "new loader",
      "rel": "check for presence of",
      "rel_type": [
        "malicious-investigates-track-detects"
      ],
      "obj": "Bitdefender"
    },
    {
      "sub": "new loader",
      "rel": "check for presence of",
      "rel_type": [
        "malicious-investigates-track-detects"
      ],
      "obj": "Dr. Web"
    },
    {
      "sub": "new loader",
      "rel": "check for presence of",
      "rel_type": [
        "malicious-investigates-track-detects"
      ],
      "obj": "Kaspersky"
    },
    {
      "sub": "new loader",
      "rel": "check for presence of",
      "rel_type": [
        "malicious-investigates-track-detects"
      ],
      "obj": "Norton"
    },
    {
      "sub": "new loader",
      "rel": "check for presence of",
      "rel_type": [
        "malicious-investigates-track-detects"
      ],
      "obj": "Trend Micro"
    },
    {
      "sub": "09ef4c6b8a297bf4cf161d4c12260ca58cc7b05eb4de6e728d55a4acd94606d4",
      "rel": "are associated with",
      "rel_type": [
        "indicates"
      ],
      "obj": "CERBER"
    },
    {
      "sub": "a61eb7c8d7a6bc9e3eb2b42e7038a0850c56e68f3fec0378b2738fe3632a7e4c",
      "rel": "are associated with",
      "rel_type": [
        "indicates"
      ],
      "obj": "CERBER"
    },
    {
      "sub": "e3e5d9f1bacc4f43af3fab28a905fa4559f98e4dadede376e199360d14b39153",
      "rel": "are associated with",
      "rel_type": [
        "indicates"
      ],
      "obj": "CERBER"
    },
    {
      "sub": "f4dbbb2c4d83c2bbdf4faa4cf6b78780b01c2a2c59bc399e5b746567ce6367dd",
      "rel": "are associated with",
      "rel_type": [
        "indicates"
      ],
      "obj": "CERBER"
    }
  ],
  "entitylist": [
    {
      "name": "CERBER",
      "type": "malware",
      "alias": [
        "CERBER family of ransomware",
        "new CERBER variants",
        "Cerber"
      ],
      "mother entity": [
        "None"
      ]
    },
    {
      "name": "new loader",
      "type": "other",
      "alias": [
        "binary file",
        "configuration file",
        "loader",
        "x"
      ],
      "mother entity": [
        "None"
      ]
    },
    {
      "name": "Delivery via email",
      "type": "attack-pattern",
      "alias": [
        "Emails that claim to be from various utilities"
      ],
      "mother entity": [
        "None"
      ]
    },
    {
      "name": "self-extracting archive",
      "type": "file",
      "alias": [
        "None"
      ],
      "mother entity": [
        "None"
      ]
    },
    {
      "name": "Dropbox account",
      "type": "account",
      "alias": [
        "None"
      ],
      "mother entity": [
        "None"
      ]
    },
    {
      "name": "Attacker(using: CERBER)",
      "type": "threat-actor-or-intrusion-set",
      "alias": [
        "attackers"
      ],
      "mother entity": [
        "None"
      ]
    },
    {
      "name": "38oDr5.vbs",
      "type": "file",
      "alias": [
        "Visual Basic script",
        "Script"
      ],
      "mother entity": [
        "None"
      ]
    },
    {
      "name": "8ivq.dll",
      "type": "file",
      "alias": [
        "DLL file",
        "DLL"
      ],
      "mother entity": [
        "None"
      ]
    },
    {
      "name": "x",
      "type": "file",
      "alias": [
        "binary file",
        "configuration file",
        "loader",
        "new loader"
      ],
      "mother entity": [
        "None"
      ]
    },
    {
      "name": "Windows Script Host",
      "type": "general-software",
      "alias": [
        "None"
      ],
      "mother entity": [
        "None"
      ]
    },
    {
      "name": "rundll32.exe",
      "type": "general-software",
      "alias": [
        "None"
      ],
      "mother entity": [
        "None"
      ]
    },
    {
      "name": "virtual machine",
      "type": "general-software",
      "alias": [
        "VM"
      ],
      "mother entity": [
        "None"
      ]
    },
    {
      "name": "sandbox",
      "type": "general-software",
      "alias": [
        "None"
      ],
      "mother entity": [
        "None"
      ]
    },
    {
      "name": "Msconfig",
      "type": "general-software",
      "alias": [
        "None"
      ],
      "mother entity": [
        "None"
      ]
    },
    {
      "name": "Regedit",
      "type": "general-software",
      "alias": [
        "None"
      ],
      "mother entity": [
        "None"
      ]
    },
    {
      "name": "Task Manager",
      "type": "general-software",
      "alias": [
        "None"
      ],
      "mother entity": [
        "None"
      ]
    },
    {
      "name": "Wireshark",
      "type": "general-software",
      "alias": [
        "None"
      ],
      "mother entity": [
        "None"
      ]
    },
    {
      "name": "360",
      "type": "security-product",
      "alias": [
        "None"
      ],
      "mother entity": [
        "None"
      ]
    },
    {
      "name": "AVG",
      "type": "security-product",
      "alias": [
        "None"
      ],
      "mother entity": [
        "None"
      ]
    },
    {
      "name": "Bitdefender",
      "type": "security-product",
      "alias": [
        "None"
      ],
      "mother entity": [
        "None"
      ]
    },
    {
      "name": "Dr. Web",
      "type": "security-product",
      "alias": [
        "None"
      ],
      "mother entity": [
        "None"
      ]
    },
    {
      "name": "Kaspersky",
      "type": "security-product",
      "alias": [
        "None"
      ],
      "mother entity": [
        "None"
      ]
    },
    {
      "name": "Norton",
      "type": "security-product",
      "alias": [
        "None"
      ],
      "mother entity": [
        "None"
      ]
    },
    {
      "name": "Trend Micro",
      "type": "identity",
      "alias": [
        "None"
      ],
      "mother entity": [
        "None"
      ]
    },
    {
      "name": "normal process",
      "type": "process",
      "alias": [
        "None"
      ],
      "mother entity": [
        "None"
      ]
    },
    {
      "name": "09ef4c6b8a297bf4cf161d4c12260ca58cc7b05eb4de6e728d55a4acd94606d4",
      "type": "indicator",
      "alias": [
        "VBSCERBER.DLCYG"
      ],
      "mother entity": [
        "None"
      ]
    },
    {
      "name": "a61eb7c8d7a6bc9e3eb2b42e7038a0850c56e68f3fec0378b2738fe3632a7e4c",
      "type": "indicator",
      "alias": [
        "RansomCERBER.ENC"
      ],
      "mother entity": [
        "CERBER"
      ]
    },
    {
      "name": "e3e5d9f1bacc4f43af3fab28a905fa4559f98e4dadede376e199360d14b39153",
      "type": "indicator",
      "alias": [
        "RansomCERBER.VSAGD"
      ],
      "mother entity": [
        "CERBER"
      ]
    },
    {
      "name": "f4dbbb2c4d83c2bbdf4faa4cf6b78780b01c2a2c59bc399e5b746567ce6367dd",
      "type": "indicator",
      "alias": [
        "TROJCERBER.AL"
      ],
      "mother entity": [
        "CERBER"
      ]
    }
  ],
  "content": "\n \nThe CERBER family of ransomware has been found to have adopted a new technique to make itself harder to detect: it is now using a new loader that appears to be designed to evade detection by machine learning solutions. This loader is designed to hollow out a normal process where the code of CERBER is insteadrun.\nBehavior and Analysis\nRansomware typically arrives via email, and these new CERBER variants are no exception. Emails that claim to be from various utilities may have been used. Theemails contain a link to a selfextracting archive, which has been uploaded to a Dropbox account controlled by the attackers. The target then downloads and opens it to infect a system. The following flow chart shows what happens next.\n\nFigure 1.Cerber behavior flowchart\nThe downloaded file is a selfextracting archivethat contains three files: a Visual Basic script, a DLL file, and a binary file that looks like a configuration file. In one sample we saw, these files are named 38oDr5.vbs, 8ivq.dll, and x, respectively.Other cases with the same behavior may have different file names, however.\n\nFigure 2. Contents of selfextracting archive\nFirst, the script is run using the Windows Script Host. The script, in turn, loads the DLL file using rundll32.exewith the DLLs filename and exports as the arguments.\nThe DLL file itself is simple and straightforward.All it does isread the configuration file (file x), decrypts part of it, and execute whatever it decrypts. The DLL file is not packed or encrypted; however, the code that it decrypted from file x is definitely malicious.\n\nFigure 3.Start of binary file in X\nX contains the loader, as well as various configuration settings. The loader has features that check if it is running in a virtual machine (VM), if it is running in a sandbox, if certain analysis tools are running on the machine, or if certain AV products are present. If any of these checks fail, the malware stops running. Thelists below highlight the specific tools and products this software checks for:\nAnalysis Tools\n\nMsconfig\nSandboxes\nRegedit\nTask Manager\nVirtual Machines\nWireshark\n\nSecurity vendors\n\n360\nAVG\nBitdefender\nDr. Web\nKaspersky\nNorton\nTrend Micro\n\nThe main payload of the loader is the injection of code in another process. In this case, the injected code is the whole Cerber binary, and it can be injected into any of the following processes:\n\nC:WindowsMicrosoft.NETFrameworkv2.0.50727csc.exe\nC:WindowsMicrosoft.NETFrameworkv2.0.50727regasm.exe\nC:WindowsMicrosoft.NETFrameworkv4.0.30319csc.exe\nC:WindowsSysWow64WerFault.exe\nC:WindowsSystem32WerFault.exe\n\nPlease note that we have provided a list of the Dropbox URLs to their security team. The URLs in question are no longer functional, and the accounts involved have been banned from the service.\nMachine Learning and Evasion\nAs a threat, Cerber has already been blocked by earlier advances in security solutions. Running Cerber in a normal process (as done by the loader) can help evade behavioral monitoring, but why go to the trouble of repackaging Cerber and using a separate loader? Earlier versions of Cerber already had a code injection routine which could mimic that particular behavior, so why was the separate loader necessary?\nThe answer lies in the adoption of the security industry of machine learning solutions. The industry hascreated features to proactively detect malicious files based on features instead of signatures. The new packaging and loading mechanism employed by Cerber can cause problems for static machine learning approachesi.e,methods that analyze a file without any execution or emulation.\nSelfextracting files and simple, straightforward files could pose a problem for static machine learning file detection. All selfextracting files may look similar by structure, regardless of the content. Unpacked binaries with limited features may not look malicious either. In other words, the way Cerber is packaged could be said to be designed to evademachine learning file detection. For every new malware detection technique, an equivalent evasion technique is created out of necessity.\nThis new evasion technique does not defeat an antimalware approach that uses multiple layers of protection. Cerber has its weaknesses against other techniques. For instance, having an unpacked .DLL file will make it easy to create a onetomany pattern; alternately having a set structure within an archive will make it easier to identify if a package is suspicious.Solutions that rely on a variety of techniques, and are not overly reliant on machine learning, can still protect customers against these threats.\nTrend Micro Solutions\nThreats will always try to get around the latest solutions, and users should avoid relying on any single approach to security. Aproactive, multilayered approach to security is more effective from the gateway, endpoints, networks, and servers.\nEndpoint solutions such as Trend Micro Smart Protection Suites, and WorryFree Business Security can protect users and businesses from these threats by detecting malicious files, and spammed messages as well as blocking all related malicious URLs.Trend Micro Deep Discovery has an email inspection layer that can protect enterprises by detecting malicious attachment and URLs.\nTrend Micro OfficeScan with XGen endpoint security infuses highfidelity machine learning with other detection technologies and global threat intelligence for comprehensive protection against ransomware and advanced malware. Our machine learning capabilities have been tuned to account for attacks using these types of evasion techniques.\nIndicators of Compromise\nFiles with the following SHA256 hashes are associated with this threat:\n\n09ef4c6b8a297bf4cf161d4c12260ca58cc7b05eb4de6e728d55a4acd94606d4 (Detected asVBSCERBER.DLCYG)\na61eb7c8d7a6bc9e3eb2b42e7038a0850c56e68f3fec0378b2738fe3632a7e4c (Detected asRansomCERBER.ENC)\ne3e5d9f1bacc4f43af3fab28a905fa4559f98e4dadede376e199360d14b39153 (Detected asRansomCERBER.VSAGD)\nf4dbbb2c4d83c2bbdf4faa4cf6b78780b01c2a2c59bc399e5b746567ce6367dd(Detected asTROJCERBER.AL)\n\nAdditional Analysis By Brian Cayanan and Jon Oliver.\n\n Learn how to protect Enterprises, Small Businesses, and Home Users from ransomware:ENTERPRISE SMALL BUSINESSHOME\n \n\n           Tags: CERBERmachine learningransomware\n\n",
  "idorurl": "60k_0049358"
}